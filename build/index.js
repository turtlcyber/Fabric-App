(()=>{var e={669:(e,t,s)=>{s(818).config(),e.exports={mongoDbUrl:process.env.MONGO_DB_URL,logDbUrl:process.env.LOG_DB_URL,tokenSecretKey:process.env.JWT_SECRET,port:process.env.PORT,adminSecretKey:process.env.ADMIN_SECRET_KEY}},865:(e,t,s)=>{const a=s(37),{mongoDbUrl:r}=s(669);e.exports={connectToDB:function(){try{a.connect(r)}catch(e){return console.log("Unable to connect to database"),e}}}},593:(e,t,s)=>{const a=s(107),r=s(829),n=s(486),i=s(903),d=s(928),{getCurrentIPAddress:u,generateRandomAlphaNumericID:o}=s(93),{port:c,tokenSecretKey:g}=s(669),m=s(935);e.exports={createAdmin:async(e,t)=>{try{let{name:s,email:r,password:g,mobile:m}=e.body;if(!(s&&r&&g&&m))return t.status(400).send({status:!1,message:"All fields are required"});let{profilePic:l}=e.files;if(!l)return t.status(400).send({status:!1,message:"No profile pic uploaded"});g=await n.hash(g,10);let p=u(),y="/adminImages/",f=i.v4()+"."+l.name.split(".").pop(),I=`http://${p}:${c}${y}`,b=d.join(__dirname,"..","..","adminImages",f);l.mv(b,(e=>{e&&console.log(e)})),picObj={picName:f,picPath:I};let S={adminId:o(26),sessionToken:o(51),name:s,email:r,password:g,mobile:m,profilePic:picObj},h=await a.create(S);return t.status(201).send({status:!0,message:"Admin created",data:h})}catch(e){return t.status(500).send({status:!1,message:e.message})}},adminLogin:async(e,t)=>{try{let{email:s,password:i}=e.body;if(!s||!i)return t.status(400).send({status:!1,message:"Email and password are required"});let d=await a.findOne({email:s});if(!d)return t.status(400).send({status:!1,message:"Bad Reques!!!"});n.compare(i,d.password,(function(e,a){if(e)throw e;!async function(e){if(e){let e={},a=Date.now(),n=Math.floor(a/1e3),i=r.sign({email:d.email,adminId:d._id.toString(),iat:n},g,{expiresIn:"24h"});return e._id=d._id.toString(),e.email=s,e.token=i,t.setHeader("Authorization","Bearer",i),d.sessionToken=o(51),await d.save(),t.status(200).send({status:!0,message:"Successfully login",data:e})}t.status(401).send({status:!1,message:"Login denied"})}(a)}))}catch(e){return t.status(500).send({status:!1,message:e.message})}},getAllBookingsOfUser:async(e,t)=>{try{const{adminId:s,sessionToken:r,userId:n}=e.params;if(!s||!r)return t.status(400).send({status:!1,message:"All fields are required"});let i=await a.findOne({adminId:s,sessionToken:r});if(!i)return t.status(404).send({status:!1,message:"Bad Reques!!!"});if(i.adminId===s&&i.sessionToken===r){if(!await m.findOne({userId:n}))return t.status(404).send({status:!1,message:"User Not Found"});let e=await bookingModel.find({userId:n});return t.status(200).send({status:!0,message:"Success",data:e})}return t.status(400).send({status:!1,message:"Session Expired"})}catch(e){return t.status(500).send({status:!1,message:e.message})}},getOneDayBookings:async(e,t)=>{try{const{adminId:s,sessionToken:r}=e.params;if(!s||!r)return t.status(400).send({status:!1,message:"All fields are required"});let n=await a.findOne({adminId:s,sessionToken:r});if(!n)return t.status(404).send({status:!1,message:"Bad Reques!!!"});if(n.adminId===s&&n.sessionToken===r){let s;if(e.params.date)s=e.params.date;else{let e=new Date;const t=e.getFullYear();s=`${t}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`}let a=await bookingModel.find({BookingDate:s}),r=0;for(let e of a)r+=e.grand_total;let n={totalBookings:a,oneDayRevenue:r};return t.status(200).send({status:!0,message:"Success",data:n})}return t.status(400).send({status:!1,message:"Session Expired"})}catch(e){return t.status(500).send({status:!1,message:e.message})}},getOneWeekBookings:async(e,t)=>{try{let{adminId:s,sessionToken:r}=e.params;if(!s||!r)return t.status(400).send({status:!1,message:"All fields are required"});let n=await a.findOne({adminId:s,sessionToken:r});if(!n)return t.status(404).send({status:!1,message:"Bad Reques!!!"});if(n.adminId===s&&n.sessionToken===r){let s,a;if(e.params.startDate&&e.params.endDate)s=e.params.startDate,a=e.params.endDate;else{const e=new Date,t=e.getFullYear();a=`${t}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`;const r=new Date(e.getTime()-6048e5),n=r.getFullYear();s=`${n}-${String(r.getMonth()+1).padStart(2,"0")}-${String(r.getDate()).padStart(2,"0")}`}let r=await bookingModel.find({BookingDate:{$gte:s,$lte:a}}),n=0;if(r.length)for(let e of r)n+=e.grand_total;let i={oneWeekBookings:r,grandTotal:n};return t.status(200).send({status:!0,message:"Success",data:i})}return t.status(403).send({status:!1,message:"Session Expired"})}catch(e){return t.status(500).send({status:!1,message:e.message})}},getOneMonthBookings:async(e,t)=>{try{const{adminId:s,sessionToken:r,month:n,year:i}=e.params;if(!(s&&r&&n&&i))return t.status(400).send({status:!1,message:"All fields are required"});let d=await a.findOne({adminId:s,sessionToken:r});if(!d)return t.status(404).send({status:!1,message:"Bad Reques!!!"});if(d.adminId===s&&d.sessionToken===r){const e=`${i}-${n}-01`,s=`${i}-${n}-31`,a=await bookingModel.find({createdAt:{$gte:e,$lte:s}});let r=0;if(a.length)for(let e of a)r+=e.grand_total;let d={oneMonthBookings:a,oneMonthRevenue:r};return t.status(200).send({status:!0,message:"Success",data:d})}return t.status(400).send({status:!1,message:"Session Expired"})}catch(e){return t.status(500).send({status:!1,message:e.message})}},getOneYearBookings:async(e,t)=>{try{const{adminId:s,sessionToken:r,year:n}=e.params;if(!s||!r||!n)return t.status(400).send({status:!1,message:"All fields are required"});let i=await a.findOne({adminId:s,sessionToken:r});if(!i)return t.status(404).send({status:!1,message:"Bad Reques!!!"});if(i.adminId===s&&i.sessionToken===r){const e=`${n}-01-01`,s=`${n}-12-31`;let a=await bookingModel.find({createdAt:{$gte:e,$lte:s}}),r=0;if(a.length)for(let e of a)r+=e.grand_total;let i={oneYearRequests:a,oneYearRevenue:r};return t.status(200).send({status:!0,message:"Success",data:i})}return t.status(400).send({status:!1,message:"Session Expired"})}catch(e){return t.status(500).send({status:!1,message:e.message})}}}},452:(e,t,s)=>{const a=s(406);let{getCurrentIPAddress:r}=s(93);const n=s(903),i=s(928),d=s(896),{port:u}=s(669),o=s(569),{isValidObjectId:c}=s(37);let g=i.join(__dirname,"..","..","categoryImages");e.exports={addCategory:async(e,t)=>{try{let{name:s,description:o}=e.body,{category_image:c}=e.files;if(!c)return t.status(400).send({status:!1,message:"No category Image uploaded"});d.existsSync(g)||d.mkdirSync(g);let m=r(),l="/categoryImages/",p=n.v4()+"."+c.name.split(".").pop(),y=`http://${m}:${u}${l}`,f=i.join(g,p);await c.mv(f);let I={name:s,description:o,category_image:{fileName:p,filePath:y}},b=await a.create(I);return t.status(200).send({status:!0,message:"Category Added",data:b})}catch(e){return t.status(400).send({status:!1,message:e.message})}},getCategoryById:async(e,t)=>{try{let s,{categoryId:r}=e.params;if(r){if(!c(r))return t.status(400).send({status:!1,message:"Invalid category Id"});s=await a.findById(r)}if(!s)return t.status(200).send({status:!0,message:"Category Not Found"});let n=await o.find({categoryId:s._id});return t.status(200).send({status:!0,message:"Success",data:s,products:n})}catch(e){return t.status(400).send({status:!1,message:e.message})}},getFabricByKeywords:async(e,t)=>{try{let{categoryId:s}=e.params,{search_data:a}=e.body;if(s){let e=await o.find({categoryId:s});return t.status(200).send({status:!0,message:"Success",data:e})}{let e={$or:[{name:{$regex:a,$options:"i"}},{fabric:{$regex:a,$options:"i"}},{color:{$regex:a,$options:"i"}},{pattern:{$regex:a,$options:"i"}},{borderType:{$regex:a,$options:"i"}},{description:{$regex:a,$options:"i"}},{brand:{$regex:a,$options:"i"}},{moreDetails:{$regex:a,$options:"i"}}]},s=await o.find(e);return t.status(200).send({status:!0,message:"Success",data:s})}}catch(e){return t.status(400).send({status:!1,message:e.message})}},getAllCategories:async(e,t)=>{try{let e=await a.find({});return t.status(200).send({status:!0,message:"Success",data:e})}catch(e){return t.status(400).send({status:!1,message:e.message})}},updateCategory:async(e,t)=>{try{let{categoryId:s}=e.params;if(!s)return t.status(400).send({status:!1,message:"Category Id is required"});if(!c(s))return t.status(400).send({status:!1,message:"Invalid Category Id"});let o=await a.findById(s);if(!o)return t.status(404).send({status:!1,message:"Category Not Found"});let m=e.body;if("name"in m&&(o.name=m.name),"description"in m&&(o.description=m.description),"category_image"in m||e.files&&e.files.category_image){let s=e.files.category_image;if(!s)return t.status(400).send({status:!1,message:"No category images uploaded"});let a=r(),c="/categoryImages/",m=n.v4()+"."+s.name.split(".").pop(),l=`http://${a}:${u}${c}`,p=i.join(g,m),y=o.category_image.imageName;if(y){let e=i.join(g,y);d.existsSync(e)&&d.unlinkSync(e)}await s.mv(p);let f={imageName:m,imagePath:l};o.category_image=f}return await o.save(),t.status(200).send({status:!0,message:"Category updated successfully",data:o})}catch(e){return t.status(400).send({status:!1,message:e.message})}},deleteCategory:async(e,t)=>{try{let{categoryId:s}=e.params;if(!s)return t.status(400).send({status:!1,message:"CategoryId is required"});let r=await a.findById(s);if(!r)return t.status(404).send({status:!1,message:"No category found with this category Id"});let n=r.category_image.fileName;if(n){let e=i.join(g,n);d.existsSync(e)&&d.unlinkSync(e)}return await a.deleteOne({_id:s}),t.status(200).send({status:!0,message:"Category deleted successfully"})}catch(e){return t.status(400).send({status:!1,message:e.message})}}}},204:(e,t,s)=>{const a=s(354),r=s(935);e.exports={createCheckout:async(e,t)=>{try{let{customerId:s,f_name:r,l_name:n,email:i,mobile:d,address:u,apartment:o,city:c,countryCode:g,post_code:m,state:l,state_code:p,countryName:y,productList:f,totalProduct:I,CGST:b,SGST:S,paymentType:h,tax:w,total:k,grandTotal:A}=e.body,O=[];for(let e of f){let{name:t,fabric:s,color:a,pattern:r,borderType:n,price:i,size:d,occasion:u,brand:o,description:c,categoryName:g,categoryId:m,fabricImages:l,moreDetails:p}=e;O.push({name:t,fabric:s,color:a,pattern:r,borderType:n,price:i,size:d,occasion:u,brand:o,description:c,categoryName:g,categoryId:m,fabricImages:l,moreDetails:p})}let v={customerId:s,f_name:r,l_name:n,email:i,mobile:d,address:u,apartment:o,city:c,countryCode:g,post_code:m,state:l,state_code:p,countryName:y,productList:f,totalProduct:I,CGST:b,SGST:S,paymentType:h,tax:w,total:k,grandTotal:A},x=await a.create(v);return t.status(200).send({status:!0,message:"checkout successfully",data:x})}catch(e){return t.status(400).send({status:!1,message:e.message})}},getUserAllBookings:async(e,t)=>{try{let{userId:s}=e.params;if(!s)return t.status(400).send({status:!1,message:"userId is required"});let n=await r.findOne({userId:s});if(!n)return t.status(404).send({status:!1,message:"User Not Found"});let i=await a.find({userId:n.userId});return t.status(200).send({status:!0,message:"Success",data:i})}catch(e){return t.status(400).send({status:!1,message:e.message})}},cancelOrderById:async(e,t)=>{try{let{orderId:s}=e.params;if(!s)return t.status(400).send({status:!1,message:"OrderId is required"});let r=e.body,{status:n,question:i,feedback:d}=r,u=await a.findOne({_id:s});if(!u)return t.status(404).send({status:!1,message:"Order not found"});if("Cancelled"===u.status)return t.status(400).send({status:!1,message:"This order is already cancelled"});if("Rejected"===u.status)return t.status(400).send({status:!1,message:"This order is already Rejected"});if(!["Cancelled","Rejected"].includes(n))return t.status(400).send({status:!1,message:"Order status can be only 'Cancelled' or 'Rejected'"});let o=await a.findOneAndUpdate({_id:s},{$set:{status:n,question:i,feedback:d}},{new:!0});return t.status(200).send({status:!0,message:"Order cancelled successfully",orderStatus:o})}catch(e){return t.status(500).send({status:!1,message:e.message})}},getAllOrders:async(e,t)=>{try{let e=await a.find({});return t.status(200).send({status:!0,message:"Order cancelled successfully",orderStatus:e})}catch(e){return t.status(500).send({status:!1,message:e.message})}}}},506:(e,t,s)=>{const a=s(406),r=s(751),{getCurrentIPAddress:n}=(s(285),s(93)),i=s(903),d=s(928),u=s(896),{port:o,adminSecretKey:c}=s(669),{isValidObjectId:g}=s(37),m=(s(569),s(935),s(354));let l=d.join(__dirname,"..","..","bannerImages");e.exports={getDashboard:async(e,t)=>{try{let{userId:s}=e.params,n=await a.find({}),i=(await r.findOne()).bannerImages,d=null;return s&&(d=await m.find({customerId:s})),t.status(200).send({status:!0,message:"Success",categoryList:n,bannerImages:i,myAllOrders:d})}catch(e){return t.status(400).send({status:!1,message:e.message})}},getAdminDashboard:async(e,t)=>{try{let e=await a.find({}),s=(await r.findOne()).bannerImages,n=await m.find({});return t.status(200).send({status:!0,message:"Success",categoryList:e,bannerImages:s,allOrders:n})}catch(e){return t.status(400).send({status:!1,message:e.message})}},updateBannerImages:async(e,t)=>{try{let{key:s}=e.params;if(!s)return t.status(400).send({status:!1,message:"Bad Request!!!"});if(s!==c)return t.status(403).send({status:!1,message:"NOT AUTHORIZED!!!"});let a=await r.findOne({});a||(a=await r.create({bannerImages:[]}));let{ImageModel:g}=e.body,m=JSON.parse(g),p=e.files.bannerImage;if(!p)return t.status(400).send({status:!1,message:"No banner image uploaded"});u.existsSync(l)||u.mkdirSync(l);let y=m.index,f=(m.img_id&&m.img_id,m.imageName,m.isNewPick),I=n(),b="/bannerImages/",S=i.v4()+"."+p.name.split(".").pop(),h=`http://${I}:${o}${b}`,w=d.join(l,S);if(f){await p.mv(w);let e={imageName:S,imagePath:h};a.bannerImages.push(e),await a.save();let s=a.bannerImages;return t.status(200).send({status:!0,message:"Banner added successfully",data:s})}{let e=a.bannerImages[y].imageName;if(e){let t=d.join(l,e);u.existsSync(t)&&u.unlinkSync(t)}await p.mv(w);let s={imageName:S,imagePath:h};a.bannerImages[y]=s,await a.save();let r=a.bannerImages;return t.status(200).send({status:!0,message:"Banner updated successfully",data:r})}}catch(e){return t.status(400).send({status:!1,message:e.message})}},deleteBannerImage:async(e,t)=>{try{let{imageId:s,key:a}=e.params;if(!s||!a)return t.status(400).send({status:!1,message:"All fields are required"});if(a!==c)return t.status(403).send({status:!1,message:"NOT AUTHORIZED!!!"});let n=await r.findOne();if(!n)return t.status(400).send({status:!1,message:"Not Found!!!"});if(n.bannerImages.length)for(let e=0;e<n.bannerImages.length;e++)if(s===n.bannerImages[e]._id.toString()){let t=n.bannerImages[e].imageName;if(t){let e=d.join(l,t);u.existsSync(e)&&u.unlinkSync(e)}let s=n.bannerImages;s.splice(e,1),n.bannerImages=s,await n.save()}let i=n.bannerImages;return t.status(200).send({status:!0,message:"Banner deleted successfully",data:i})}catch(e){return t.status(400).send({status:!1,message:e.message})}}}},743:(e,t,s)=>{const a=s(935),r=s(285),{adminSecretKey:n}=s(669),i=s(569);e.exports={submitEnquiry:async(e,t)=>{try{let s,a,{userId:n,fabircId:i,questions:d,enquiryData:u}=e.body;do{s=Math.floor(1e9+8999999999*Math.random()),a=await r.findOne({enquiryId:s})}while(a);let o={enquiryId:s,userId:n,fabircId:i,questions:d,enquiryData:u},c=await r.create(o);return t.status(200).send({status:!0,message:"Success",data:c})}catch(e){return t.status(400).send({status:!1,message:e.message})}},getAllEnquiries:async(e,t)=>{try{let{key:s}=e.params;if(!s)return t.status(400).send({status:!1,message:"key is required"});if(s!==n)return t.status(403).send({status:!1,message:"Not Authorized"});let d=await r.find({}),u=[];if(d.length)for(let e of d){let t=await i.findOne({_id:e.fabricId.toString()}),s={enquiry:e,fabric:t,user:await a.findOne({userId:e.userId})};u.push(s)}return t.status(200).send({status:!0,message:"Success",data:u})}catch(e){return t.status(400).send({status:!1,message:e.message})}},deleteEnquiry:async(e,t)=>{try{let{enquiryId:s}=e.params;return s?await r.deleteOne({_id:s})?t.status(200).send({status:!0,message:"Enquiry deleted successfully"}):t.status(400).send({status:!1,message:"Enquiry not found"}):t.status(400).send({status:!1,message:"Enquiry Id is required"})}catch(e){return t.status(400).send({status:!1,message:e.message})}}}},321:(e,t,s)=>{const a=s(569);let{getCurrentIPAddress:r}=s(93);const n=s(903),i=s(928),d=s(896),{port:u,adminSecretKey:o}=s(669),{isValidObjectId:c}=s(37);let g=i.join(__dirname,"..","..","fabricImages");e.exports={addFabric:async(e,t)=>{try{let{key:s}=e.params;if(!s)return t.status(400).send({status:!1,message:"key is required"});if(s!==o)return t.status(403).send({status:!1,message:"NOT AUTHORIZED!!!"});let{name:r,fabric:n,color:i,pattern:d,borderType:u,price:c,size:g,occasion:m,brand:l,description:p,categoryName:y,categoryId:f,moreDetails:I}=e.body,b={name:r,fabric:n,color:i,pattern:d,borderType:u,price:c,size:g,occasion:m,brand:l,description:p,categoryName:y,categoryId:f,moreDetails:I},S=await a.create(b);return t.status(200).send({status:!0,message:"Fabric Added Successfully",property:S})}catch(e){return t.status(400).send({status:!1,message:e.message})}},addUpdateFabricImages:async(e,t)=>{try{let{fabricId:s}=e.params;if(!s)return t.status(400).send({status:!1,message:"Bad Request!!!"});if(!c(s))return t.status(403).send({status:!1,message:"Invalid fabricId!!!"});let o=await a.findById(s);if(!o)return t.status(400).send({status:!1,message:"fabric not found"});let{ImageModel:m}=e.body,l=JSON.parse(m),p=e.files.itemImage;if(!p)return t.status(400).send({status:!1,message:"No property image uploaded"});d.existsSync(g)||d.mkdirSync(g);let y=l.index,f=(l.img_id&&l.img_id,l.imageName,l.isNewPick),I=r(),b="/fabricImages/",S=n.v4()+"."+p.name.split(".").pop(),h=`http://${I}:${u}${b}`,w=i.join(g,S);if(f){await p.mv(w);let e={fileName:S,filePath:h};o.fabricImages.push(e),await o.save();let s=o.fabricImages;return t.status(200).send({status:!0,message:"Fabric image added successfully",data:s})}{let e=o.fabricImages[y].fileName;if(e){let t=i.join(g,e);d.existsSync(t)&&d.unlinkSync(t)}await p.mv(w);let s={fileName:S,filePath:h};o.fabricImages[y]=s,await o.save();let a=o.fabricImages;return t.status(200).send({status:!0,message:"Fabric image updated successfully",data:a})}}catch(e){return t.status(400).send({status:!1,message:e.message})}},deleteFabricImage:async(e,t)=>{try{let{fabricId:s,imageId:r}=e.params;if(!r||!s)return t.status(400).send({status:!1,message:"All fields are required"});let n=await a.findById(s);if(!n)return t.status(400).send({status:!1,message:"Not Found!!!"});for(let e of n.fabricImages)if(r===e._id.toString()){let t=e.fileName;if(t){let e=i.join(g,t);d.existsSync(e)&&d.unlinkSync(e)}let s=n.fabricImages,a=s.indexOf(e);s.splice(a,1),n.fabricImages=s,await n.save()}let u=n.fabricImages;return t.status(200).send({status:!0,message:"fabric image deleted successfully",data:u})}catch(e){return t.status(400).send({status:!1,message:e.message})}},getAllFabricList:async(e,t)=>{try{let e=await a.find({});return t.status(200).send({status:!0,message:"Success",data:e})}catch(e){return t.status(400).send({status:!1,message:e.message})}},updateFabric:async(e,t)=>{try{let{fabricId:s}=e.params;if(!s)return t.status(400).send({status:!1,message:"fabricId is required"});if(!c(s))return t.status(400).send({status:!1,message:"Invalid fabricId"});let r=await a.findById(s);if(!r)return t.status(400).send({status:!1,message:"fabric not found"});let n=e.body;return"name"in n&&(r.name=n.name),"fabric"in n&&(r.fabric=n.fabric),"color"in n&&(r.color=n.color),"pattern"in n&&(r.pattern=n.pattern),"borderType"in n&&(r.borderType=n.borderType),"price"in n&&(r.price=n.price),"size"in n&&(r.size=n.size),"occasion"in n&&(r.occasion=n.occasion),"brand"in n&&(r.brand=n.brand),"description"in n&&(r.description=n.description),"categoryName"in n&&(r.categoryName=n.categoryName),"categoryId"in n&&(r.categoryId=n.categoryId),"moreDetails"in n&&(r.moreDetails=n.moreDetails),await r.save(),t.status(200).send({status:!0,message:"fabric Updated Successfully",property:r})}catch(e){return t.status(400).send({status:!1,message:e.message})}},deleteFabric:async(e,t)=>{try{let{fabricId:s}=e.params;if(!s)return t.status(400).send({status:!1,message:"fabricId is required"});if(!c(s))return t.status(400).send({status:!1,message:"Invalid fabricId"});let r=await a.findById(s);if(!r)return t.status(400).send({status:!1,message:"fabric not found"});for(let e of r.fabricImages){let t=e.fileName;if(t){let e=i.join(g,t);d.existsSync(e)&&d.unlinkSync(e)}}return await a.findOneAndDelete({_id:s}),t.status(200).send({status:!0,message:"fabric deleted successfully"})}catch(e){return t.status(400).send({status:!1,message:e.message})}}}},579:(e,t,s)=>{const a=s(935),r=(s(107),s(950)),{getCurrentIPAddress:n,generateRandomAlphaNumericID:i}=(s(903),s(928),s(896),s(93)),{port:d}=s(669),{isValidObjectId:u}=s(37),{adminSecretKey:o}=s(669);e.exports={authenticateUser:async(e,t)=>{try{let{email:s,phone:r,profilePic:n,name:i,userId:d}=e.body;const u=await a.findOne({userId:d});if(u)return t.status(200).send({status:!0,message:"Authentication successful",data:u});{let e={userId:d,name:i,email:s,phone:r,profilePic:n},u=await a.create(e);return t.status(200).send({status:!0,message:"Authentication successful",data:u})}}catch(e){return t.status(400).send({status:!1,message:e.message})}},updateUser:async(e,t)=>{try{const{userId:s}=e.params;if(!s)return t.status(400).send({status:!1,message:"userId is required"});let r=await a.findOne({userId:s});if(!r)return t.status(400).send({status:!1,message:"User not found"});let n=e.body;return"name"in n&&(r.name=n.name),"phone"in n&&(r.phone=n.phone),"gender"in n&&(r.gender=n.gender),"date_of_birth"in n&&(r.date_of_birth=n.date_of_birth),"Address"in n&&("address"in n.Address&&(r.Address.address=n.Address.address),"apartment"in n.Address&&(r.Address.apartment=n.Address.apartment),"city"in n.Address&&(r.Address.city=n.Address.city),"post_code"in n.Address&&(r.Address.post_code=n.Address.post_code),"state"in n.Address&&(r.Address.state=n.Address.state)),await r.save(),t.status(200).send({status:!0,message:"User updated successfully",data:r})}catch(e){return t.status(400).send({status:!1,message:e.message})}},deleteUser:async(e,t)=>{try{let{userId:s}=e.params;if(!s)return t.status(400).send({status:!1,message:"userId is required"});let n=await a.findOne({userId:s});if(!n)return t.status(400).send({status:!1,message:"User not found"});const{reason:i,feedback:d}=e.body;let u={user:n,userAllBookings:await bookingModel.find({userId:s})},o=JSON.stringify(u);await a.deleteOne({userId:s});let c={userId:s,deletedUserData:o,reason:i||"",feedback:d||"",deletedAt:(new Date).toLocaleString()};return await r.create(c),t.status(200).send({status:!0,message:"User deleted successfully"})}catch(e){return console.log("Error deleting user",e.message),t.status(400).send({status:!1,message:e.message})}},getUserById:async(e,t)=>{try{let{userId:s,key:r}=e.params;if(!s||!r)return t.status(400).send({status:!1,message:"All fields are required"});if(r!==o)return t.status(403).send({status:!1,message:"NOT AUTHORIZED!!!"});let n=await a.findOne({userId:s});return n?t.status(200).send({status:!0,message:"Success",data:n}):t.status(400).send({status:!1,message:"User not found"})}catch(e){return t.status(400).send({status:!1,message:e.message})}},getAllUsers:async(e,t)=>{try{let{key:s}=e.params;if(!s)return t.status(400).send({status:!1,message:"key is required"});if(s!==o)return t.status(403).send({status:!1,message:"NOT AUTHORIZED!!!"});let r=await a.find({});return t.status(200).send({status:!0,message:"Success",data:r})}catch(e){return t.status(400).send({status:!1,message:e.message})}}}},797:e=>{class t extends Error{constructor(e,t,s,a){super(s),this.name=e,this.statusCode=t,this.details=a}}e.exports=t},526:(e,t,s)=>{const{isValidObjectId:a}=s(37),{tokenSecretKey:r}=s(669),n=s(107),i=s(829);e.exports={Authentication:async(e,t,s)=>{try{let a=e.headers.authorization;if(!a)return t.status(400).send({status:!1,message:"Token is required"});let n,d=a.split(" ")[1];if(!d)return t.status(400).send({status:!1,message:"Invalid token"});i.verify(d,r,((t,a)=>{if(t)throw t;n=a;let r=n.adminId;e.adminId=r,s()}))}catch(e){return t.status(500).send({status:!1,message:e.message})}},Authorization:async(e,t,s)=>{try{let r=e.adminId,{adminId:i}=e.params;if(!a(i))return t.status(400).send({status:!1,message:"Invalid userId"});let d=await n.findById(i);if(!d)return t.status(404).send({status:!1,message:"Admin not found"});let u=d._id;if(r.toString()!==u.toString())return t.status(403).send({status:!1,message:"NOT AUTHORIZED!!!"});s()}catch(e){return t.status(500).send({status:!1,message:e.message})}}}},107:(e,t,s)=>{const a=s(37),r=(a.Schema.Types.ObjectId,new a.Schema({adminId:{type:String},sessionToken:{type:String},name:{type:String},email:{type:String},password:{type:String},mobile:{type:String},profilePic:{picName:{type:String},picPath:{type:String}}},{timestamps:!0}));e.exports=a.model("Admin",r)},751:(e,t,s)=>{const a=s(37),r=new a.Schema({bannerImages:[{imageName:{type:String,default:""},imagePath:{type:String,default:""}}]},{timestamps:!0});e.exports=a.model("BannerImage",r)},406:(e,t,s)=>{const a=s(37),r=(a.Schema.Types.ObjectId,new a.Schema({name:{type:String,default:""},description:{type:String,default:""},category_image:{fileName:{type:String,default:""},filePath:{type:String,default:""}},cat_enum:{type:String,enum:["",""]}},{timestamps:!0}));e.exports=a.model("Category",r)},354:(e,t,s)=>{const a=s(37),r=new a.Schema({customerId:{type:String},f_name:{type:String},l_name:{type:String},email:{type:String},mobile:{type:String},address:{type:String},apartment:{type:String},city:{type:String},post_code:{type:String},state:{type:String},state_code:{type:String},countryName:{type:String},countryCode:{type:String},productList:[{name:{type:String},fabric:{type:String},color:{type:String},pattern:{type:String},borderType:{type:String},price:{type:Number},size:{type:String},occasion:{type:String},brand:{type:String},description:{type:String},categoryName:{type:String},categoryId:{type:String},fabricImages:[{fileName:{type:String},filePath:{type:String}}],moreDetails:[{type:a.Schema.Types.Mixed}]}],totalProduct:{type:Number},CGST:{type:Number},SGST:{type:Number},paymentType:{type:String},tax:{type:Number},total:{type:Number},grandTotal:{type:Number},status:{type:String,enum:["Pending","Approved","Rejected","Shipped","Completed","Cancelled"],default:"Pending"},question:{type:String},feedback:{type:String}},{timestamps:!0});e.exports=a.model("Checkout",r)},950:(e,t,s)=>{const a=s(37),r=new a.Schema({userId:{type:String},deletedUserData:{type:String},reason:{type:String},feedback:{type:String},deletedAt:{type:String}},{timestamps:!0});e.exports=a.model("DeletedUser",r)},285:(e,t,s)=>{const a=s(37),r=a.Schema.Types.ObjectId,n=new a.Schema({enquiryId:{type:String},userId:{type:String,default:""},fabricId:{type:r,ref:"Fabric"},questions:[String],enquiryData:{type:String}},{timestamps:!0});e.exports=a.model("Enquiry",n)},569:(e,t,s)=>{const a=s(37),r=(a.Schema.Types.ObjectId,new a.Schema({name:{type:String},fabric:{type:String},color:{type:String},pattern:{type:String},borderType:{type:String},price:{type:Number},size:{type:String},occasion:{type:String},brand:{type:String},description:{type:String},categoryName:{type:String},categoryId:{type:String},fabricImages:[{fileName:{type:String},filePath:{type:String}}],moreDetails:[{type:a.Schema.Types.Mixed}]},{timestamps:!0}));e.exports=a.model("Fabric",r)},935:(e,t,s)=>{const a=s(37),r=(a.Schema.Types.ObjectId,new a.Schema({userId:{type:String,unique:!0,trim:!0,default:""},name:{type:String,required:!0,trim:!0},profilePic:{type:String},gender:{type:String,enum:["MALE","FEMALE","OTHER","UNDEFINED"],default:"UNDEFINED"},Address:{address:{type:String,default:""},apartment:{type:String,default:""},city:{type:String,default:""},post_code:{type:String,default:""},state:{type:String,default:""}},email:{type:String,default:""},phone:{type:String,default:""},date_of_birth:{type:String,default:""}},{timestamps:!0}));e.exports=a.model("User",r)},508:(e,t,s)=>{const a=s(252).Router(),{createAdmin:r,adminLogin:n,getOneDayBookings:i,getOneWeekBookings:d,getOneMonthBookings:u,getOneYearBookings:o,getAllBookingsOfUser:c}=s(593),{Authentication:g,Authorization:m}=s(526);a.post("/api/v1/createSuperAdmin",r),a.post("/api/v1/loginSuperAdmin",n),a.get("/api/v1/getOneDayBookings/:adminId/:sessionToken/:date?",i),a.get("/api/v1/getOneWeekBookings/:adminId/:sessionToken/:startDate?/:endDate?",d),a.get("/api/v1/getOneMonthBookings/:adminId/:sessionToken/:month/:year",u),a.get("/api/v1/getOneYearBookings/:adminId/:sessionToken/:year",o),a.get("/api/v1/getUserAllBookings/:adminId/:sessionToken/:userId",c),e.exports=a},683:(e,t,s)=>{const a=s(252).Router(),{addCategory:r,getCategoryById:n,getFabricByKeywords:i,getAllCategories:d,updateCategory:u,deleteCategory:o}=s(452);a.post("/api/v1/addCategory",r),a.post("/api/v1/viewService/:categoryId",n),a.post("/api/v1/allSareeSearchByKeywords/:categoryId?",i),a.get("/api/v1/getAllCategories",d),a.put("/api/v1/updateCategory/:categoryId",u),a.delete("/api/v1/deleteCategory/:categoryId",o),e.exports=a},799:(e,t,s)=>{const a=s(252).Router(),{createCheckout:r,getUserAllBookings:n,cancelOrderById:i,getAllOrders:d}=s(204);a.post("/api/v1/createCheckout",r),a.get("/api/v1/getAllOrdersOfAUser/:userId",n),a.put("/api/v1/cancelOrder/:orderId",i),a.get("/api/v1/getAllorders",d),e.exports=a},51:(e,t,s)=>{const a=s(252).Router(),{getDashboard:r,updateBannerImages:n,deleteBannerImage:i,getAdminDashboard:d}=s(506);a.get("/api/v1/getDashboard/:userId?",r),a.get("/api/v1/getAdminDashboard",d),a.put("/api/v1/addOrUpdateBanner/:key",n),a.delete("/api/v1/deleteBanner/:imageId/:key",i),e.exports=a},902:(e,t,s)=>{const a=s(252).Router(),{submitEnquiry:r,deleteEnquiry:n,getAllEnquiries:i}=s(743);a.post("/api/v1/submitEnquiry",r),a.get("/api/v1/getAllEnquiries/:key",i),a.delete("/api/v1/deleteEnquiry/:enquiryId",n),e.exports=a},134:(e,t,s)=>{const a=s(252).Router(),{addFabric:r,addUpdateFabricImages:n,deleteFabricImage:i,getAllFabricList:d,updateFabric:u,deleteFabric:o}=s(321);a.post("/api/v1/addFabric/:key",r),a.post("/api/v1/addOrUpdateFabricImages/:fabricId",n),a.delete("/api/v1/deleteFabricImage/:fabricId/:imageId",i),a.get("/api/v1/getAllFabricList",d),a.put("/api/v1/updateFabric/:fabricId",u),a.delete("/api/v1/deleteFabric/:fabricId",o),e.exports=a},768:(e,t,s)=>{const a=s(252).Router(),{authenticateUser:r,updateUser:n,getAllUsers:i,getUserById:d,deleteUser:u}=s(579);a.post("/api/v1/authenticateUser",r),a.get("/api/v1/getUser/:userId/:key",d),a.get("/api/v1/users/:key",i),a.post("/api/v1/updateUser/:userId",n),a.delete("/api/v1/deleteUser/:userId",u),e.exports=a},48:(e,t,s)=>{const a=s(797),{StatusCodes:r}=s(138);e.exports={errorHandler:function(e,t,s,n){return e instanceof a?s.status(e.statusCode).json({success:!1,message:e.message,err:e.details,data:{}}):s.status(r.INTERNAL_SERVER_ERROR).json({success:!1,message:"Something went wrong",err:e,data:{}})}}},93:(e,t,s)=>{const a=s(857);e.exports={getCurrentIPAddress:()=>{let e=a.networkInterfaces();return Object.values(e).flat().filter((e=>"IPv4"===e.family&&!e.internal)).map((e=>e.address))[0]},generateRandomAlphaNumericID:function(e){let t="";for(let s=0;s<e;s++)t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789"[Math.floor(62*Math.random())];return t}}},486:e=>{"use strict";e.exports=require("bcrypt")},268:e=>{"use strict";e.exports=require("body-parser")},577:e=>{"use strict";e.exports=require("cors")},818:e=>{"use strict";e.exports=require("dotenv")},252:e=>{"use strict";e.exports=require("express")},376:e=>{"use strict";e.exports=require("express-fileupload")},138:e=>{"use strict";e.exports=require("http-status-codes")},829:e=>{"use strict";e.exports=require("jsonwebtoken")},37:e=>{"use strict";e.exports=require("mongoose")},903:e=>{"use strict";e.exports=require("uuid")},896:e=>{"use strict";e.exports=require("fs")},857:e=>{"use strict";e.exports=require("os")},928:e=>{"use strict";e.exports=require("path")}},t={};function s(a){var r=t[a];if(void 0!==r)return r.exports;var n=t[a]={exports:{}};return e[a](n,n.exports,s),n.exports}const a=s(252),r=s(268),n=s(376),i=s(577),{port:d}=s(669),{connectToDB:u}=s(865),{errorHandler:o}=s(48),c=a();c.use(a.json({limit:"50mb"})),c.use(a.urlencoded({extended:!0,limit:"50mb"})),c.use(r.json({limit:"50mb"})),c.use(r.text({limit:"50mb"})),c.use(n()),c.use(i());const g=s(508),m=s(799),l=s(768),p=s(134),y=s(683),f=s(51),I=s(902);c.use("/userImages",a.static(__dirname+"/userImages")),c.use("/fabricImages",a.static(__dirname+"/fabricImages")),c.use("/categoryImages",a.static(__dirname+"/categoryImages")),c.use("/icons",a.static(__dirname+"/icons")),c.use("/bannerImages",a.static(__dirname+"/bannerImages")),c.use("/",g),c.use("/",l),c.use("/",p),c.use("/",y),c.use("/",f),c.use("/",I),c.use("/",m),c.get("/",((e,t)=>{t.send("<h1>Fabric App is Up and Running</h1>")})),c.use(o),c.listen(d,(async()=>{console.log("Server is running on port",d),await u(),console.log("Database connected")}))})();
//# sourceMappingURL=index.js.map